\section{Исследование алгоритма}
\label{sec:AlgoResearch_4} \index{AlgoResearch_4}
\large


\subsection{Определение класса решаемых задач}
Предложенный алгоритм является универсальным. Используя различный формат вводимых данных, можно решать следующие задачи:
\begin{enumerate}
\item Нахождение группы автоморфизмов произвольной квадратной матрицы.
\item Нахождение левой и правой групп автоморфизомв произваольной матрицы (т.е. блок-схем, дискретных функций и т.д.).
\item Нахождение всех изоморфизмов матрицы $A$ на матрицу $B$.
\item Нахождение всех изоморфных вложений матрицы $A$ в матрицу $B$.
\item Поиск клик.
\item Решение задачи Коши в подстановках.
\item Нахождение группы автоморфизмов матрицы Адамара.
\item Нахождение всех изомофризмов кода $A$ на код $B$.
\end{enumerate}

В рамках дипломной работы рассматриваются первые шесть задач.

\subsection{Анализ}

Алгоритм применим для любых графов, но для удобство рассматриваются случайные графы, матрицы смежности которых состоят из нулей и едениц.
В этом случае получена оценка сложности алгоритма в среднем.

Так как граф случайный, элементы матрицы смежности графа равны $1$ или $0$ с вероятностью $\frac{1}{2}$. Необходимо вычислить наиболее вероятные размеры для каждого множества $M'_k$.

Если рассмотреть построение множеств, не учитывая промежуточного критерия, то на $k$-ом шаге множество увеличивается \ в $(n-k)$ раз (так как для каждого элемента $g^s_{(k-1)} = (r_1, \ldots, r_{k-1})$ добавляется $r_k$ из оставшихся $(n-k)$ вариантов): $|M_{k+1}| = |M_{k}|(n-k)= n(n-1)\ldots(n-k)$.

С учетом критерия получается:

\begin{enumerate}
\item Из построения множества $M'_1$ следует $|M'_1|\thickapprox\frac{|M_1|}{2}$ (элемент $a_{11}$ = $a_{r_1r_1}$ с вероятностью $\frac{1}{2}$).
\item На $(k+1)$-ом шаге требуется совпадение $((k+1) + (k+1) - 1)$ элементов. Так как граф случайный (матрица с равновероятным распределением $0$ и $1$), то на этом шаге $|M'_{k+1}| = \frac{1}{2^{2m+1}}|M_k|$ элементов.
\end{enumerate}

 Учитывая построение $\{M'_k\}$ и пункты 1, 2 получим
 
 $|M'_{k+1}| \thickapprox \frac{n!}{(n-k-1)!~2^{(k+1)^2}} \thickapprox \frac{1}{e^{k+1}} \frac{n^{n+1/2}}{(n-k-1)^{(n-k-1/2)}~2^{(k+1)^2}}$. Последнее равенство получено используя формулу Стирлинга: $n!\thickapprox \sqrt{2\pi n}(\frac{n}{e})^n$, при большом $n$.
 


Далее необходимо рассмотреть последовательность $\{|M'_{k+1}|\}$. 

$|M'_{k+1}| = \frac{n(n-1)\ldots(n-k)}{2^{(k+1)^2}} \le \frac{n^{k+1}}{2^{(k+1)^2}}$

Равенство $n^{k+1} = 2^{(k+1)^2}$ означает, что в множестве осталось небольшое количество элементов. Данное равенство далее будет называться стабилизацией последовательности $\{M'_k\}$, а $k$ - значением стабилизации.

После решения данного равенства, получается, что стабилизация наступает при $k \thickapprox \log _2(n) $.
Это означает, что с вероятностью близкой к единице (для случайного графа) уже на $k = \lceil\log _2(n) \rceil$ шаге мы обнаружим отсутствие или наличие автоморфизма (в статье это выдвигается как тезис).

Вычисление номера множества $k$ в последовательности $\{|M'_{k}|\}$, соответствующий самому большому множеству:

Пусть $|M'_{k+1}|:$ $|M'_{k+1}| = f(k+1)$, 

$f'(k+1) = \frac{\ln(n)n^{k+1}2^{(k+1)^2}-(2k+2)\ln(2)2^{(k+1)^2}n^{k+1}}{(2^{(m+1)^2})^2}$. 

Получается уравнение:

$\ln(n) - (2k+2)\ln(2) = 0\ \Rrightarrow \  k+1 \thickapprox \frac{5}{7}\ln(n) - 1$. 

Так как $k$ и $n$ целые, то 

$k + 1 = \lceil(\frac{5}{7}\ln(n) - 1)\rceil)$.

Необходимо отметить, что в тот момент, когда $k \thickapprox \log _2(n)$, можно судить о том, существуют автоморфизмы в графе или нет. Если размер множества $M_k = 1$ (только тождественная подстановка), можно утверждать с вероятностью близкой к 1, что автоморфизмов, кроме тривиальной подстановки, не существует. Если $M_k > 1$, то, наоборот, с вероятностью близкой к 1 автоморфизм существует. Данный факт позволяет сэкономить память и уменьшить количество операций при поиске автоморфизмов в тех графах, в которых они существуют.

Опираясь на вышесказанное, получены оценки:
\begin{itemize}
\item значение стабилизации 

$k \thickapprox \log _2(n)$
\item номер наибольшего по количеству элементов множества 

$k \thickapprox \frac{5}{7}\ln(n)$
\item ограничение на размер множества 

$|M'_k| = \frac{n(n-1)\ldots(n-k-1)}{2^{(k)^2}} \le \frac{n^{k}}{2^{(k)^2}}$
\item приблизительное количество операций в секунду:

$\frac{n^{(5/7) \ln(n)}}{2^{((5/7)\ln(n))^2}}\times n(2(\frac{5}{7}\ln(n)) + 1)\times \log_2(n)$

\item затраты оперативной памяти: 

$2 \times \frac{n^{(5/7) \ln(n)}}{2^{((5/7)\ln(n))^2}} \times \log_2(n)$
\end{itemize}

\subsection{Вероятностная сложность}

Сложность всего алгоритма представляет собой сумму сложностей вычисления $M'_1 \ldots M'_n$.

Количество элементов в каждом множестве (с вероятностью близкой к единице):

$ |M'_{k}| \thickapprox \frac{n!}{(n-k-2)!~2^{(k)^2}} \thickapprox \frac{1}{e^{k}} \frac{n^{n+1/2}}{(n-k-2)^{(n-k-3/2)}~2^{(k)^2}} $

Можно оценить: $ |M'_k| = \frac{n(n-1)\ldots(n-k-1)}{2^{(k)^2}} \le \frac{n^{k}}{2^{(k)^2}} $

Количество операций сравнения для подсчета всех множеств:

$ \sum_{k = 1}^{n} \frac{1}{e^{k}} \frac{n^{n+1/2}}{(n-k-2)^{(n-k-3/2)}~2^{(k)^2}} \times (n - k)(2k + 1)$

Оценка (были учтены точка стабилизации и точка максимума последовательности множеств):

$ n \times \frac{n^{(5/7) \ln(n)}}{2^{((5/7)\ln(n))^2}}\times n(2(\frac{5}{7}\ln(n)) + 1)\times \log_2(n) = O(n^2(\frac{e}{2})^{\ln(n)^2} \ln(n))$

Сложность экспоненциальная.

\subsection{Теоретическая возможность распараллеливания}

Каждое множество $ M_i (i = 2 \ldots n) $ вычисляется из $ M'_{i-1} $ путем добавления в каждый элемент (частичная перестановка, представленная вектором целых чисел) из $ M'_{i-1} $ всех возможных оставшихся чисел, которых нет в соответствующем элементе.

Для этого удобно использовать 2 не фиксированных по количеству строк двумерных массива размера t на n (t может увеличиваться), хранящих частичные отображения, такого вида: 

\[
\begin{pmatrix}
{
a_{11} & a_{12} & \ldots &a_{1i} & ? & \ldots & ? \cr
a_{21} & a_{22} & \ldots &a_{2i} & ? & \ldots & ? \cr \ldots \cr
a_{k1} & a_{k2} & \ldots &a_{ki} & ? & \ldots & ? \cr
?      & ?      & \ldots &   ?   & ? & \ldots & ? \cr
\ldots \cr
?      & ?      & \ldots &   ?   & ? & \ldots & ? \cr
}
\end{pmatrix}
\]

? - эти значения не известны и заполняются постепенно.

Один массив для $ M'_{i-1} $, другой для вычисления из предыдущего $ M_i $.
Из каждой строки множества $ M'_{i-1} $ (первый массив), в соответствие с алгоритмом, получается $ n $ новых строк длины i, которые записываются во второй массив (расширяется, если нужно).

После этого, второй массив копируется в первый и запускается цикл по всем векторам. Вектор исключается из массива, если $ a_{ji} $ равен какому-либо числу в данном векторе или вектор с $ a_{ji} $ является частичной перестановкой, не удовлетворяющей критерию.
