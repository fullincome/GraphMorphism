\section{Структура алгоритма}
\label{sec:AlgoStruct_3} \index{AlgoStruct_3}
\large

\subsection{Проверка по критерию}

Критерием $h$ является проверка подматриц на равенство. Предположим, требуется определить, удовлетворяет ли элемент $g^s_k$ критерию h. Для этого необходимо, чтобы элементы $a_{ij}$, для всех $i,j \leq k$, были равны соответствующим элементам $a_{r_ir_j}$. Подматрица $g^s_k$ выглядит так:

\[ \bordermatrix{
& r_1 & r_2 & \dots & r_k \cr
r_1 & a_{r_1r_1} & a_{r_1r_2} & \dots & a_{r_1r_k} \cr
r_2 & a_{r_2r_1} & a'_{r_2r_2} & \dots & a_{r_2r_k} \cr
\vdots & \vdots & \vdots & \ddots & \vdots \cr
r_k & a_{r_kr_1} & a_{r_kr_2} & \dots & a_{r_kr_k} \cr}
\]

Если хотя бы одно из равенств не выполнено, это означает, что по данной частичной подстановке хотя бы одна вершина отобразилась в другую так, что структура графа изменилась. А так как частичная перестановка $g^s_k$ фиксирует $r_1, \ldots r_k$, то структура останется измененой, что означает отображение не будет являться автоморфизмом.



\subsection{Построение множеств частичных отображений}

Описание построения $M'_n$.

На первом этапе рассматриваются все $g^s_1$, образующие множество $M_1$. Каждый элемент $g^s_1$ проверяется по критерию h. Элементы, удовлетворяющие h, образуют $M'_1$. В каждый элемент из $M'_1$ добавляется еще одно отображение (2 $\to$ $r_2$), т.о. происходит переход от $g^s_1$ к $g^s_2$. Из каждого $g^s_1$ получается разных $(n-1)$ элементов $g^s_2$. Всевозможные элементы $g^s_2$ образуют $M_2$. Далее строится $M'_2$, добавляя в него только те элементы из $M_2$, которые удовлетворяют критерию. Аналогично получаются множества $M_3,\ M'_3,\ M_4,\ldots, M_n,\ M'_n$.


Таким образом, получается последовательнось множеств частичных отображенией:

$\{M'_k\}$: $M'_1 \subseteq M'_2 \subseteq \ldots \subseteq M'_n$.

Множество $M'_n$ является множеством всех возможных автоморфизмов (или пустое, если их нет).